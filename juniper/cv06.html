
<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>6. cvičení.md</title>
    <link rel="stylesheet" href="../styly.css">
</head>
<body class="stackedit">
    <div class="stackedit__html">
        <h2>Loopback</h2>
<pre><code class="language-console"># set interfaces lo0 unit 0 family inet address &lt;address&gt;/&lt;mask&gt;
</code></pre>
<h2>ASN - Autonomous System Number</h2>
<pre><code class="language-console"># set routing-options autonomous-system &lt;as-number&gt;
</code></pre>
<h2>Router-ID</h2>
<pre><code class="language-console"># set routing-options router-id &lt;router-id&gt;
</code></pre>
<h2>OSPF</h2>
<pre><code class="language-console"># set protocols ospf area &lt;ospf-area&gt; interface &lt;interface-name&gt; &lt;passive&gt;
</code></pre>
<ul>
<li>Passive nastavujeme na porty, kam nechceme posílat Hello pakety, např. na loopbacky</li>
</ul>
<h3>Diagnostické příkazy</h3>
<pre><code class="language-console">show ospf overview
show ospf neighbor
show ospf route
</code></pre>
<h2>BGP</h2>
<pre><code class="language-console"># set protocols bgp group &lt;group-name&gt; type &lt;type&gt;
</code></pre>
<ul>
<li>type: interní a externí</li>
</ul>
<pre><code class="language-console"># set protocols bgp group &lt;group-name&gt; peer-as &lt;asn&gt;
# set protocols bgp group &lt;group-name&gt; neighbor &lt;neighbor&gt;
</code></pre>
<ul>
<li>neighbor je IP adresa vedlejšího routeru</li>
<li>např. na Juniper2 bude tato adresa 192.168.1.1 pro router ISP1, viz obrázek</li>
<li><img alt="topology_cv06" src="./src/topology_cv06.png" /></li>
</ul>
<pre><code class="language-console">set protocols bgp group &lt;group-name&gt; local-address &lt;address&gt;
</code></pre>
<ul>
<li>Z předchozí situace to bude adresa 192.168.1.10+X</li>
<li>Tento údaj není povinný, ale je doporučený</li>
</ul>
<h3>Diagnostické příkazy</h3>
<pre><code class="language-console">show bgp neighbor
show bgp summary
</code></pre>
<h2>Route import (export) - policy</h2>
<pre><code class="language-json">policy-options {
    policy-statement &lt;policy-name&gt; {
        from protocol &lt;protocol-name&gt;;
        then accept;
    }
}
</code></pre>
<h2>Route import (export) - OSPF</h2>
<pre><code class="language-json">protocols {
    ospf {
        &lt;import/export&gt; &lt;policy-name&gt;;
    }
}
</code></pre>
<h2>Route import (export) - BGP</h2>
<pre><code class="language-json">protocols {
    bgp {
        group &lt;group-name&gt; {
            &lt;import/export&gt; &lt;policy-name&gt;;
        }
    }
}
</code></pre>
<h1>Exprot/Import policy prakticky</h1>
<ul>
<li>Export je pro předání cest jinému protokolu</li>
</ul>
<h2>Route export policy - BGP</h2>
<pre><code class="language-json">policy-options {
    policy-statement bgp_to_ospf {
        from protocol bgp;
        then accept;
    }
}
</code></pre>
<pre><code class="language-json">policy-options {
    policy-statement ospf_to_bgp {
        from protocol ospf;
        then accept;
    }
}
</code></pre>
<ul>
<li>BGP automaticky nerozesílá cesty k přímo připojeným linkám, je potřeba to povolit:</li>
</ul>
<pre><code class="language-json">policy-options {
    policy-statement direct_to_bgp {
        from protocol direct;
        then accept;
    }
}
</code></pre>
<h2>Route export - OSPF</h2>
<pre><code class="language-json">protocols {
    ospf {
        export bgp_to_ospf;
    }
}
</code></pre>
<h2>Route export - BGP</h2>
<pre><code class="language-json">protocols {
    bgp {
        group &lt;group-name&gt; {
            export ospf_to_bgp;
        }
    }
}
</code></pre>
<h2>Route export - BGP</h2>
<pre><code class="language-json">protocols {
    bgp {
        group &lt;group-name&gt; {
            export direct_to_bgp;
        }
    }
}
</code></pre>
    </div>
</body>
</html>
